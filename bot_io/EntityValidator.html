        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>EntityValidator abstract class / bot_io Library / BOT Documentation</title>
        <link rel="stylesheet" type="text/css"
            href="../styles.css">
        <link href="//fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="../favicon.ico">
        
        </head>
        <body data-library="bot_io" data-type="EntityValidator">
        <div class="page">
        <div class="header">
          <a href="../index.html"><div class="logo"></div></a>
          <a href="../index.html">BOT Documentation</a>
         &rsaquo; <a href="../bot_io.html">bot_io</a> &rsaquo; <a href="../bot_io/EntityValidator.html">EntityValidator</a>        <div id="search-box">
          <input type="search" name="q" id="q" autocomplete="off"
              class="search-input" placeholder="Search API">
        </div>
        
      </div>
      <div class="drop-down" id="drop-down"></div>
      
        <div class="nav">
        
</div>
<div class="content">
        <h2><strong>EntityValidator</strong>
          abstract class
        </h2>
        
<button id="show-inherited" class="show-inherited">Hide inherited</button>
<div class="doc">
<pre class="source">
abstract class EntityValidator {

 static Stream&lt;String&gt; validateFileStringContent(File entity,
     String targetContent) {
   return validateFileContentSha(entity, _getStringSha1(targetContent));
 }

 static Stream&lt;String&gt; validateFileContentSha(File entity, String targetSha) {
   if(entity is! File) {
     return new Stream.fromIterable(['entity is not a File']);
   }
   assert(targetSha != null);
   assert(targetSha.length == 40);

   var future = fileSha1Hex(entity)
       .then((String sha1) {
         if(sha1 == targetSha) {
           return [];
         } else {
           return ['content does not match: $entity'];
         }
       });

   return _streamFromIterableFuture(future);
 }

 static Stream&lt;String&gt; validateDirectoryFromMap(Directory entity,
     Map&lt;String, dynamic&gt; map) {
   if(entity is! Directory) {
     return new Stream.fromIterable(['entity is not a Directory']);
   }

   final expectedItems = new Set.from(map.keys);

   return expandStream(entity.list(), (FileSystemEntity item) {

     final relative = pathos.relative(item.path,
         from: entity.path);

     final expected = expectedItems.remove(relative);
     if(expected) {
       return validate(item, map[relative]);
     } else {
       return new Stream.fromIterable(['Not expected: $item']);
     }

   }, onDone: () {
     return new Stream.fromIterable(expectedItems.map((item) {
         return 'Missing item $item';
       }));
   });
 }

 static Stream&lt;String&gt; validate(FileSystemEntity entity, dynamic target) {
   if(target is EntityValidator) {
     return target.validateEntity(entity);
   } else if(target is String) {
     return validateFileStringContent(entity, target);
   } else if(target is Map) {
     return validateDirectoryFromMap(entity, target);
   } else {
     throw "Don't know how to deal with $target";
   }
 }

 Stream&lt;String&gt; validateEntity(FileSystemEntity entity);
}
</pre>
</div>
<h3>Subclasses</h3>
<p>
<span class="type-box"><span class="icon-class"></span><a href="../bot_io/EntityExistsValidator.html">EntityExistsValidator</a></span></p>
<div>
<h3>Static Methods</h3>
<div class="method"><h4 id="validateFileStringContent">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_async/Stream.html">Stream</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt; <strong>validateFileStringContent</strong>(<a href="http://api.dartlang.org/dart_io/File.html">File</a> entity, <a href="http://api.dartlang.org/dart_core/String.html">String</a> targetContent) <a class="anchor-link" href="#validateFileStringContent"
              title="Permalink to EntityValidator.validateFileStringContent">#</a></h4>
<div class="doc">
<pre class="source">
static Stream&lt;String&gt; validateFileStringContent(File entity,
   String targetContent) {
 return validateFileContentSha(entity, _getStringSha1(targetContent));
}
</pre>
</div>
</div>
<div class="method"><h4 id="validateFileContentSha">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_async/Stream.html">Stream</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt; <strong>validateFileContentSha</strong>(<a href="http://api.dartlang.org/dart_io/File.html">File</a> entity, <a href="http://api.dartlang.org/dart_core/String.html">String</a> targetSha) <a class="anchor-link" href="#validateFileContentSha"
              title="Permalink to EntityValidator.validateFileContentSha">#</a></h4>
<div class="doc">
<pre class="source">
static Stream&lt;String&gt; validateFileContentSha(File entity, String targetSha) {
 if(entity is! File) {
   return new Stream.fromIterable(['entity is not a File']);
 }
 assert(targetSha != null);
 assert(targetSha.length == 40);

 var future = fileSha1Hex(entity)
     .then((String sha1) {
       if(sha1 == targetSha) {
         return [];
       } else {
         return ['content does not match: $entity'];
       }
     });

 return _streamFromIterableFuture(future);
}
</pre>
</div>
</div>
<div class="method"><h4 id="validateDirectoryFromMap">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_async/Stream.html">Stream</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt; <strong>validateDirectoryFromMap</strong>(<a href="http://api.dartlang.org/dart_io/Directory.html">Directory</a> entity, <a href="http://api.dartlang.org/dart_core/Map.html">Map</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>, dynamic&gt; map) <a class="anchor-link" href="#validateDirectoryFromMap"
              title="Permalink to EntityValidator.validateDirectoryFromMap">#</a></h4>
<div class="doc">
<pre class="source">
static Stream&lt;String&gt; validateDirectoryFromMap(Directory entity,
   Map&lt;String, dynamic&gt; map) {
 if(entity is! Directory) {
   return new Stream.fromIterable(['entity is not a Directory']);
 }

 final expectedItems = new Set.from(map.keys);

 return expandStream(entity.list(), (FileSystemEntity item) {

   final relative = pathos.relative(item.path,
       from: entity.path);

   final expected = expectedItems.remove(relative);
   if(expected) {
     return validate(item, map[relative]);
   } else {
     return new Stream.fromIterable(['Not expected: $item']);
   }

 }, onDone: () {
   return new Stream.fromIterable(expectedItems.map((item) {
       return 'Missing item $item';
     }));
 });
}
</pre>
</div>
</div>
<div class="method"><h4 id="validate">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_async/Stream.html">Stream</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt; <strong>validate</strong>(<a href="http://api.dartlang.org/dart_io/FileSystemEntity.html">FileSystemEntity</a> entity, target) <a class="anchor-link" href="#validate"
              title="Permalink to EntityValidator.validate">#</a></h4>
<div class="doc">
<pre class="source">
static Stream&lt;String&gt; validate(FileSystemEntity entity, dynamic target) {
 if(target is EntityValidator) {
   return target.validateEntity(entity);
 } else if(target is String) {
   return validateFileStringContent(entity, target);
 } else if(target is Map) {
   return validateDirectoryFromMap(entity, target);
 } else {
   throw "Don't know how to deal with $target";
 }
}
</pre>
</div>
</div>
</div>
<div>
<h3>Methods</h3>
<div class="method"><h4 id="validateEntity">
abstract <a href="http://api.dartlang.org/dart_async/Stream.html">Stream</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt; <strong>validateEntity</strong>(<a href="http://api.dartlang.org/dart_io/FileSystemEntity.html">FileSystemEntity</a> entity) <a class="anchor-link" href="#validateEntity"
              title="Permalink to EntityValidator.validateEntity">#</a></h4>
<div class="doc">
</div>
</div>
</div>
        </div>
        <div class="clear"></div>
        </div>
        <div class="footer">
          
        </div>
        <script async src="../client-live-nav.js"></script>
        </body></html>
        
